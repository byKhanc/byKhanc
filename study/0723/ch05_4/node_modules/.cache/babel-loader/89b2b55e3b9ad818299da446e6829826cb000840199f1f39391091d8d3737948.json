{"ast":null,"code":"import{useRef}from'react';import{useDrag,useDrop}from'react-dnd';import{jsx as _jsx}from\"react/jsx-runtime\";export const ListDraggable=_ref=>{let{id,index,onMove,style,className,...props}=_ref;const ref=useRef(null);const[{handlerId},drop]=useDrop({accept:'list',collect(monitor){return{handlerId:monitor.getHandlerId()};},hover(item){if(!ref.current){return;}const dragIndex=item.index;const hoverIndex=index;if(dragIndex===hoverIndex){return;}onMove(dragIndex,hoverIndex);item.index=hoverIndex;}});const[{isDragging},drag]=useDrag({type:'list',item:()=>{return{id,index};},collect:monitor=>({isDragging:monitor.isDragging()})});const opacity=isDragging?0:1;drag(drop(ref));return/*#__PURE__*/_jsx(\"div\",{ref:ref,...props,className:[className,'cursor-move'].join(' '),style:{...style,opacity},\"data-handler-id\":handlerId});};","map":{"version":3,"names":["useRef","useDrag","useDrop","jsx","_jsx","ListDraggable","_ref","id","index","onMove","style","className","props","ref","handlerId","drop","accept","collect","monitor","getHandlerId","hover","item","current","dragIndex","hoverIndex","isDragging","drag","type","opacity","join"],"sources":["C:/Users/82102/dev/projects/byKhanc/study/0723/ch05_4/src/components/ListDraggable.tsx"],"sourcesContent":["import type {FC} from 'react'\r\nimport {useRef} from 'react'\r\nimport type {DivProps} from './Div'\r\nimport {useDrag, useDrop} from 'react-dnd'\r\nimport type {Identifier} from 'dnd-core'\r\n\r\nexport type MoveFunc = (dragIndex: number, hoverIndex: number) => void\r\n\r\nexport type ListDraggableProps = DivProps & {\r\n  id: any\r\n  index: number\r\n  onMove: MoveFunc\r\n}\r\n\r\ninterface DragItem {\r\n  index: number\r\n  id: string\r\n  type: string\r\n}\r\n\r\nexport const ListDraggable: FC<ListDraggableProps> = ({\r\n  id,\r\n  index,\r\n  onMove,\r\n  style,\r\n  className,\r\n  ...props\r\n}) => {\r\n  const ref = useRef<HTMLDivElement>(null)\r\n  const [{handlerId}, drop] = useDrop<DragItem, void, {handlerId: Identifier | null}>({\r\n    accept: 'list',\r\n    collect(monitor) {\r\n      return {\r\n        handlerId: monitor.getHandlerId()\r\n      }\r\n    },\r\n    hover(item: DragItem) {\r\n      if (!ref.current) {\r\n        return\r\n      }\r\n      const dragIndex = item.index\r\n      const hoverIndex = index\r\n      if (dragIndex === hoverIndex) {\r\n        return\r\n      }\r\n      onMove(dragIndex, hoverIndex)\r\n      item.index = hoverIndex\r\n    }\r\n  })\r\n\r\n  const [{isDragging}, drag] = useDrag({\r\n    type: 'list',\r\n    item: () => {\r\n      return {id, index}\r\n    },\r\n    collect: (monitor: any) => ({\r\n      isDragging: monitor.isDragging()\r\n    })\r\n  })\r\n\r\n  const opacity = isDragging ? 0 : 1\r\n  drag(drop(ref))\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      {...props}\r\n      className={[className, 'cursor-move'].join(' ')}\r\n      style={{...style, opacity}}\r\n      data-handler-id={handlerId}\r\n    />\r\n  )\r\n}\r\n"],"mappings":"AACA,OAAQA,MAAM,KAAO,OAAO,CAE5B,OAAQC,OAAO,CAAEC,OAAO,KAAO,WAAW,QAAAC,GAAA,IAAAC,IAAA,yBAiB1C,MAAO,MAAM,CAAAC,aAAqC,CAAGC,IAAA,EAO/C,IAPgD,CACpDC,EAAE,CACFC,KAAK,CACLC,MAAM,CACNC,KAAK,CACLC,SAAS,CACT,GAAGC,KACL,CAAC,CAAAN,IAAA,CACC,KAAM,CAAAO,GAAG,CAAGb,MAAM,CAAiB,IAAI,CAAC,CACxC,KAAM,CAAC,CAACc,SAAS,CAAC,CAAEC,IAAI,CAAC,CAAGb,OAAO,CAAiD,CAClFc,MAAM,CAAE,MAAM,CACdC,OAAOA,CAACC,OAAO,CAAE,CACf,MAAO,CACLJ,SAAS,CAAEI,OAAO,CAACC,YAAY,CAAC,CAClC,CAAC,CACH,CAAC,CACDC,KAAKA,CAACC,IAAc,CAAE,CACpB,GAAI,CAACR,GAAG,CAACS,OAAO,CAAE,CAChB,OACF,CACA,KAAM,CAAAC,SAAS,CAAGF,IAAI,CAACb,KAAK,CAC5B,KAAM,CAAAgB,UAAU,CAAGhB,KAAK,CACxB,GAAIe,SAAS,GAAKC,UAAU,CAAE,CAC5B,OACF,CACAf,MAAM,CAACc,SAAS,CAAEC,UAAU,CAAC,CAC7BH,IAAI,CAACb,KAAK,CAAGgB,UAAU,CACzB,CACF,CAAC,CAAC,CAEF,KAAM,CAAC,CAACC,UAAU,CAAC,CAAEC,IAAI,CAAC,CAAGzB,OAAO,CAAC,CACnC0B,IAAI,CAAE,MAAM,CACZN,IAAI,CAAEA,CAAA,GAAM,CACV,MAAO,CAACd,EAAE,CAAEC,KAAK,CAAC,CACpB,CAAC,CACDS,OAAO,CAAGC,OAAY,GAAM,CAC1BO,UAAU,CAAEP,OAAO,CAACO,UAAU,CAAC,CACjC,CAAC,CACH,CAAC,CAAC,CAEF,KAAM,CAAAG,OAAO,CAAGH,UAAU,CAAG,CAAC,CAAG,CAAC,CAClCC,IAAI,CAACX,IAAI,CAACF,GAAG,CAAC,CAAC,CACf,mBACET,IAAA,QACES,GAAG,CAAEA,GAAI,IACLD,KAAK,CACTD,SAAS,CAAE,CAACA,SAAS,CAAE,aAAa,CAAC,CAACkB,IAAI,CAAC,GAAG,CAAE,CAChDnB,KAAK,CAAE,CAAC,GAAGA,KAAK,CAAEkB,OAAO,CAAE,CAC3B,kBAAiBd,SAAU,CAC5B,CAAC,CAEN,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}